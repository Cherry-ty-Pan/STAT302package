---
title: "Project 3: STAT302package Tutorial"
author: Cherry Pan & Yi-Hsuan Wu
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{STAT302package Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
# Attach libraries used for this part of tutorial
library(ggplot2)
library(kableExtra)
library(STAT302package)
library(class)
library(palmerpenguins)
library(randomForest)
library(magrittr)
library(dplyr)
library(gapminder)
library(tibble)

```


## 1. Introduction

This is the final project for STAT302. A package called "STAT302package" is created, and it includes four functions: `my_t_test`, `my_lm`, `my_knn_cv`, and `my_rf_cv``.
package collaborators: Cherry Pan & Yi-Hsuan Wu.

The guide to install the package:
```{r, eval = FALSE}
devtools::install_github("Cherry-ty-Pan/STAT302package", build_vignette = TRUE, build_opts = c())
library(STAT302package)
# Use this to view the vignette in the Demo HTML help
help(package = "STAT302package", help_type = "html")
# Use this to view the vignette as an isolated HTML file
utils::browseVignettes(package = "STAT302package")
```


## 2. Tutorial for `my_t.test`

Use the `lifeExp` data from `my_gapminder` for the following tests

### Case I: alternative = "two.sided"
 \begin{align}
  H_0: \mu &= 60,\\
  H_a: \mu &\neq 60.
  \end{align}
  
```{r}
my_t.test(my_gapminder$lifeExp, mu = 60, alternative = "two.sided")
```


### Case II: alternative = "less"
  \begin{align}
  H_0: \mu &= 60,\\
  H_a: \mu &< 60.
  \end{align}
  
```{r}
my_t.test(my_gapminder$lifeExp, mu = 60, alternative = "less")
```


### case III: alternative = "greater"
  \begin{align}
  H_0: \mu &= 60,\\
  H_a: \mu &> 60.
  \end{align}
```{r}
my_t.test(my_gapminder$lifeExp, mu = 60, alternative = "greater")
```


## 3. Tutorial for `my_lm`
```{r}
# a regression using `lifeExp` as the response variable and `gdpPercap` and
# `continent` as explanatory variables
my_lm(lifeExp ~ gdpPercap + continent, data = my_gapminder)
```

```{r}

```

## 4. Tutorial for `my_knn_cv` using `my_penguins`
predict output class `species` using covariates `bill_length_mm`, `bill_depth_mm`, `flipper_length_mm`, and `body_mass_g` with 5-fold cross validation (`k_cv = 5`)

For each value of `k_nn`, record the training misclassification rate and the CV misclassification rate (output from the function)
```{r}
my_penguins <- na.omit(my_penguins)
train_err <- rep(NA, 10)
cv_err <- rep(NA, 10)
name <- c("k_nn", "training error", "CV error")
for (i in 1:10) {
  test <- my_knn_cv(my_penguins[, 3:6], my_penguins$species, 1, 5)
  train_err[i] <- sum(my_penguins$species != test[[1]]) / nrow(my_penguins)
  cv_err[i] <- test[[2]]
}
record <- data.frame("k_nn" = c(1:10), 
                     "Training Error" = train_err, 
                     "CV Error" = cv_err)
kable_styling(kable(record))
```



## 5. Tutorial for `my_rf_cv`
```{r my_rf_cv}

# run functions for 30 times with k = 2, 5, 10.
cv_2 <- replicate(30, my_rf_cv(2))
cv_5 <- replicate(30, my_rf_cv(5))
cv_10 <- replicate(30, my_rf_cv(10))
# Store results as a data frame
cv_df <- data.frame("k" = c(rep(2,30),rep(5,30), rep(10,30)),
                 "cv" = c(cv_2,cv_5,cv_10))
# Plot the results as a boxplot
cv_plot <- ggplot(cv_df, aes(factor(k), cv)) +
  geom_boxplot() +
  labs(x = c("k"), y = c("CV estimated MSE"))
cv_plot
# Display table with 
cv_table <- data.frame("k" = c(2, 5, 10),
                       "Mean" = c(mean(cv_2),mean(cv_5),mean(cv_10)),
                       "Standard Deviation" = c(sd(cv_2),sd(cv_5),sd(cv_10)))
kable_styling(kable(cv_table))
                       
```
From the boxplot, it's observed that CV estimated MSE has greatest mean when k = 2,
which is above 120000. However, by inspecting the table, we can see standard deviation
of CV estimated MSE is greatest when k = 10. The reason may be due to that 2 folds 
yield  greatest MSE and 5 folds yield greatest variance in this data set.
